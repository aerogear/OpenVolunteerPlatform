(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{116:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return l})),n.d(t,"default",(function(){return u}));var a=n(1),r=n(6),o=(n(0),n(125)),i={id:"keycloak-authz",title:"Out of the box Keycloak based authentication",sidebar_label:"Keycloak Auth"},c={id:"keycloak-authz",title:"Out of the box Keycloak based authentication",description:"## Authorization using Keycloak",source:"@site/../docs/integrations_graphback_keycloak.md",permalink:"/docs/keycloak-authz",editUrl:"https://github.com/aerogear/OpenVolunteerPlatform/edit/master/website/../docs/integrations_graphback_keycloak.md",sidebar_label:"Keycloak Auth",sidebar:"docs",previous:{title:"Data Model",permalink:"/docs/datamodel"},next:{title:"AMQ Live updates",permalink:"/docs/liveupdates"}},l=[{value:"Authorization using Keycloak",id:"authorization-using-keycloak",children:[]},{value:"Customization",id:"customization",children:[]}],s={rightToc:l};function u(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"authorization-using-keycloak"},"Authorization using Keycloak"),Object(o.b)("p",null,"Graphback Keycloak Authz enables ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.keycloak.org/"}),"Keycloak")," integration in ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://graphback.dev"}),"Graphback")," based applications. This enables you to declaratively add authorization capabilities like role based access on top of the CRUD model that is used within the Open Volunteer Platform."),Object(o.b)("p",null,"Under the hood, Open Volunteer authorization is designed to work with ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.npmjs.com/package/keycloak-connect"}),Object(o.b)("inlineCode",{parentName:"a"},"keycloak-connect"))," and ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.npmjs.com/package/keycloak-connect-graphql"}),Object(o.b)("inlineCode",{parentName:"a"},"keycloak-connect-graphql")),". ",Object(o.b)("inlineCode",{parentName:"p"},"keycloak-connect")," is the official Keycloak middleware for Express applications. ",Object(o.b)("inlineCode",{parentName:"p"},"keycloak-connect-graphql")," provides deeper Keycloak integration into GraphQL servers."),Object(o.b)("h2",{id:"customization"},"Customization"),Object(o.b)("p",null,"Open Volunteer Platform provides out of the box Keycloak integration. "),Object(o.b)("p",null,"The authorization rules in place are defined in ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"../platform/server/src/config/auth.ts"}),Object(o.b)("inlineCode",{parentName:"a"},"server/src/config/auth.ts")),". The initial configurations looks like below:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),"export const authConfig: CrudServicesAuthConfig = {\n  DistributionCentre: {\n    create: { roles: ['admin'] },\n    read: { roles: [] },\n    update: { roles: ['admin'] },\n    delete: { roles: ['admin'] },\n  },\n  Volunteer: {\n    create: { roles: ['admin'] },\n    read: { roles: [] },\n    update: { roles: [] },\n    delete: { roles: ['admin'] },\n  },\n  Recipient: {\n    create: { roles: ['admin'] },\n    read: { roles: [] },\n    update: { roles: ['admin'] },\n    delete: { roles: ['admin'] },\n  },\n  VolunteerAction: {\n    create: { roles: ['admin'] },\n    read: { roles: [] },\n    update: { roles: ['admin'] },\n    delete: { roles: ['admin'] },\n  },\n  VolunteerActionProduct: {\n    create: { roles: ['admin'] },\n    read: { roles: [] },\n    update: { roles: ['admin'] },\n    delete: { roles: ['admin'] },\n  },\n}\n")),Object(o.b)("p",null,"With this configuration the following rules are in place."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Only Admin users can create, update and delete entities, and all users can read them.")),Object(o.b)("p",null,"You modify this file to add additional rules when you new business models are added or if you need to modify custom existing rules."))}u.isMDXComponent=!0},125:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n(0),r=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=r.a.createContext({}),u=function(e){var t=r.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):c({},t,{},e)),n},p=function(e){var t=u(e.components);return r.a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},b=Object(a.forwardRef)((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),p=u(n),b=a,m=p["".concat(i,".").concat(b)]||p[b]||d[b]||o;return n?r.a.createElement(m,c({ref:t},s,{components:n})):r.a.createElement(m,c({ref:t},s))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=b;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:a,i[1]=c;for(var s=2;s<o;s++)i[s]=n[s];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"}}]);